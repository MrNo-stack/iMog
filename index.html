<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iMog: Financial Face-Off</title>
    <!-- Dependencies -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --mogger-neon: #ff00ff;
            --soyboy-neon: #00ffff;
            --arcade-yellow: #ffff00;
            --arcade-red: #ff0000;
        }
        body {
            background: radial-gradient(circle at center, #1a0b2e 0%, #0d0221 100%);
            color: #fff;
            font-family: 'Press Start 2P', cursive;
            margin: 0;
            overflow-x: hidden;
        }
        .crt-overlay {
            position: fixed;
            top: 0; left: 0; width: 100vw; height: 100vh;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), 
                        linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 4px, 3px 100%;
            pointer-events: none;
            z-index: 100;
        }
        .panel {
            background: #111;
            border: 6px solid #444;
            box-shadow: 10px 10px 0px #000;
            position: relative;
        }
        .mogger-panel { border-color: var(--mogger-neon); box-shadow: 10px 10px 0px #4a004a; }
        .soyboy-panel { border-color: var(--soyboy-neon); box-shadow: 10px 10px 0px #004a4a; }
        
        .character-box {
            height: 250px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            background: linear-gradient(180deg, #1a0b2e 0%, #2d1b4e 70%, #4b2d7a 100%);
            border-bottom: 6px solid #fff;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
        }

        .floor-grid {
            position: absolute;
            bottom: 0;
            width: 200%;
            height: 40px;
            background-image: linear-gradient(0deg, transparent 24%, rgba(255, 255, 255, .05) 25%, rgba(255, 255, 255, .05) 26%, transparent 27%, transparent 74%, rgba(255, 255, 255, .05) 75%, rgba(255, 255, 255, .05) 76%, transparent 77%, transparent), linear-gradient(90deg, transparent 24%, rgba(255, 255, 255, .05) 25%, rgba(255, 255, 255, .05) 26%, transparent 27%, transparent 74%, rgba(255, 255, 255, .05) 75%, rgba(255, 255, 255, .05) 76%, transparent 77%, transparent);
            background-size: 20px 20px;
            transform: perspective(40px) rotateX(45deg);
            animation: moveGrid 2s linear infinite;
        }

        @keyframes moveGrid {
            from { transform: perspective(40px) rotateX(45deg) translateY(0); }
            to { transform: perspective(40px) rotateX(45deg) translateY(20px); }
        }

        input, select {
            background: #000;
            border: 3px solid #555;
            color: #0f0;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
            padding: 10px;
            width: 100%;
            outline: none;
            transition: all 0.2s;
        }
        input:focus { border-color: var(--arcade-yellow); background: #111; }
        input:disabled { color: #444; border-color: #222; }

        .vs-logo {
            font-size: 50px;
            color: #ff0000;
            text-shadow: 4px 4px 0 #ffff00, 8px 8px 0 #000;
            transform: rotate(-10deg);
            z-index: 50;
        }
        
        /* High Detail Animations */
        .win-pose { animation: winJump 0.5s infinite alternate ease-in-out; }
        .ko-pose { 
            transform: rotate(90deg) translateY(60px) scale(0.9); 
            opacity: 1.0; 
            filter: none;
        }
        
        @keyframes winJump { 
            0% { transform: translateY(0) scale(1.1); filter: brightness(1); } 
            100% { transform: translateY(-30px) scale(1); filter: brightness(1.5); } 
        }

        .aura-mogger {
            position: absolute;
            width: 150px; height: 150px;
            background: radial-gradient(circle, rgba(255,0,255,0.2) 0%, transparent 70%);
            animation: pulseAura 1s infinite alternate;
        }
        .aura-soyboy {
            position: absolute;
            width: 150px; height: 150px;
            background: radial-gradient(circle, rgba(0,255,255,0.2) 0%, transparent 70%);
            animation: pulseAura 1.5s infinite alternate;
        }
        @keyframes pulseAura {
            from { transform: scale(0.8); opacity: 0.3; }
            to { transform: scale(1.3); opacity: 0.7; }
        }

        .blood-pool {
            position: absolute;
            bottom: 5px;
            width: 80px;
            height: 20px;
            background: #800;
            border-radius: 50%;
            filter: blur(2px);
            opacity: 0.8;
            z-index: 5;
            animation: expandBlood 2s forwards;
        }

        @keyframes expandBlood {
            from { transform: scale(0.1); opacity: 0; }
            to { transform: scale(1); opacity: 0.8; }
        }
    </style>
</head>
<body class="p-4 md:p-10">
    <div class="crt-overlay"></div>
    
    <div class="max-w-7xl mx-auto relative z-10">
        <!-- HUD -->
        <div class="flex justify-between items-center bg-black border-[6px] border-[#555] p-4 mb-10 shadow-[inset_0_0_20px_#000]">
            <div class="w-2/5">
                <div class="flex justify-between mb-1">
                    <span class="text-pink-500 text-[10px]">P1: CHAD MOGGER</span>
                    <span id="mogger-hp-text" class="text-white text-[8px]">100%</span>
                </div>
                <div class="h-6 w-full bg-[#222] border-4 border-white">
                    <div id="mogger-health" class="h-full bg-gradient-to-r from-pink-600 to-pink-400 transition-all duration-700 shadow-[0_0_10px_#ff00ff]" style="width: 100%;"></div>
                </div>
            </div>
            <div class="vs-logo">VS</div>
            <div class="w-2/5 text-right">
                <div class="flex justify-between mb-1">
                    <span id="soyboy-hp-text" class="text-white text-[8px]">100%</span>
                    <span class="text-cyan-400 text-[10px]">P2: TECH SOYBOY</span>
                </div>
                <div class="h-6 w-full bg-[#222] border-4 border-white">
                    <div id="soyboy-health" class="h-full bg-gradient-to-l from-cyan-600 to-cyan-400 transition-all duration-700 shadow-[0_0_10px_#00ffff] float-right" style="width: 100%;"></div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
            <!-- MOGGER PANEL -->
            <div class="panel mogger-panel p-6">
                <div class="character-box mb-6" id="mogger-box">
                    <div class="floor-grid"></div>
                </div>
                <h2 class="text-center text-pink-500 mb-6 text-xs tracking-widest">GIGA-MOGGER LOADOUT</h2>
                <div class="grid grid-cols-2 gap-x-4 gap-y-6 text-[8px]">
                    <div class="col-span-2">
                        <label class="block mb-2">PROPERTY VALUE</label>
                        <input type="number" id="propCost" value="450000">
                    </div>
                    <div>
                        <label class="block mb-2">WARCHEST (LUMP)</label>
                        <input type="number" id="initialInvestMogger" value="90000" disabled>
                    </div>
                    <div>
                        <label class="block mb-2">LOAN RATE %</label>
                        <input type="number" id="interestRate" step="0.1" value="6.8">
                    </div>
                    <div>
                        <label class="block mb-2">LOAN TERM (YRS)</label>
                        <input type="number" id="loanTermMogger" value="30">
                    </div>
                    <div>
                        <label class="block mb-2">WARCHEST GROWTH %</label>
                        <input type="number" id="investReturn" value="9">
                    </div>
                    <div>
                        <label class="block mb-2">PROPERTY GROWTH RATE %</label>
                        <input type="number" id="growthRateMogger" step="0.1" value="3.5">
                    </div>
                    <div>
                        <label class="block mb-2">BATTLE DURATION (YRS)</label>
                        <input type="number" id="timeHorizon" value="20">
                    </div>
                </div>
            </div>

            <!-- SOYBOY PANEL -->
            <div class="panel soyboy-panel p-6">
                <div class="character-box mb-6" id="soyboy-box">
                    <div class="floor-grid"></div>
                </div>
                <h2 class="text-center text-cyan-400 mb-6 text-xs tracking-widest">BETA-SOYBOY LOADOUT</h2>
                <div class="grid grid-cols-2 gap-x-4 gap-y-6 text-[8px]">
                    <div class="col-span-2">
                        <label class="block mb-2">PROPERTY VALUE</label>
                        <input type="number" id="propCostSoy" value="450000">
                    </div>
                    <div>
                        <label class="block mb-2">DOWN PAYMENT</label>
                        <input type="number" id="downPayment" value="90000">
                    </div>
                    <div>
                        <label class="block mb-2">MONTHLY INVESTMENT</label>
                        <input type="number" id="monthlyInvestSoyboy" value="0" disabled>
                    </div>
                    <div>
                        <label class="block mb-2">LOAN TERM (YRS)</label>
                        <input type="number" id="loanTermSoyboy" value="30">
                    </div>
                    <div>
                        <label class="block mb-2">PROPERTY GROWTH RATE %</label>
                        <input type="number" id="growthRateSoyboy" step="0.1" value="3.5">
                    </div>
                    
                    <div class="col-span-2 bg-black border-2 border-green-500 p-3 text-center mt-2 shadow-[0_0_10px_rgba(0,255,0,0.2)]">
                        <div class="text-green-400 text-[7px] mb-2 uppercase">Budget Saved for Monthly Investment</div>
                        <div id="monthly-diff" class="text-white text-xl font-bold">$0</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- WINNER BANNER -->
        <div class="bg-black border-[8px] border-yellow-400 p-8 text-center mt-10 shadow-[0_0_30px_rgba(255,255,0,0.4)] relative">
            <div class="absolute -top-6 left-1/2 -translate-x-1/2 bg-yellow-400 text-black px-4 py-1 text-[10px]">FINISH HIM!</div>
            <div id="winner-text" class="text-4xl text-yellow-400 mb-6 [text-shadow:6px_6px_#f00] tracking-tighter italic">CALCULATING...</div>
            <div class="grid grid-cols-2 gap-8 text-[10px]">
                <div class="border-r border-gray-800">
                    <div class="text-pink-500 mb-2">MOGGER TOTAL EQUITY</div>
                    <div id="final-mogger" class="text-2xl text-white">$0</div>
                </div>
                <div>
                    <div class="text-cyan-400 mb-2">SOYBOY TOTAL EQUITY</div>
                    <div id="final-soyboy" class="text-2xl text-white">$0</div>
                </div>
            </div>
        </div>

        <!-- CHART -->
        <div class="mt-10 bg-black border-8 border-[#333] p-5 shadow-2xl">
            <canvas id="mainChart"></canvas>
        </div>
    </div>

    <script>
        const getInputs = () => {
            return {
                propCost: parseFloat(document.getElementById('propCost').value) || 0,
                interestRate: parseFloat(document.getElementById('interestRate').value) || 0,
                loanTerm: parseFloat(document.getElementById('loanTermMogger').value) || 0,
                growthRate: parseFloat(document.getElementById('growthRateMogger').value) || 0,
                downPayment: parseFloat(document.getElementById('downPayment').value) || 0,
                investReturn: parseFloat(document.getElementById('investReturn').value) || 0,
                timeHorizon: parseFloat(document.getElementById('timeHorizon').value) || 0
            };
        };

        // Sync inputs
        const sync = (id1, id2) => {
            document.getElementById(id1).addEventListener('input', (e) => { document.getElementById(id2).value = e.target.value; update(); });
            document.getElementById(id2).addEventListener('input', (e) => { document.getElementById(id1).value = e.target.value; update(); });
        };
        sync('propCost', 'propCostSoy');
        sync('growthRateMogger', 'growthRateSoyboy');
        sync('loanTermMogger', 'loanTermSoyboy');
        document.getElementById('downPayment').addEventListener('input', (e) => {
            document.getElementById('initialInvestMogger').value = e.target.value;
            update();
        });

        const calcMortgage = (p, r, y) => {
            const mR = r / 100 / 12;
            const n = y * 12;
            if (mR === 0) return p / n;
            return (p * mR * Math.pow(1 + mR, n)) / (Math.pow(1 + mR, n) - 1);
        };

        const renderSprites = (winner) => {
            const moggerBox = document.getElementById('mogger-box');
            const soyboyBox = document.getElementById('soyboy-box');
            const isMogWin = winner === 'MOGGER';
            
            // Re-inject floor grid
            moggerBox.innerHTML = '<div class="floor-grid"></div>';
            soyboyBox.innerHTML = '<div class="floor-grid"></div>';

            // Add blood pool if loser
            if (isMogWin) {
                soyboyBox.innerHTML += '<div class="blood-pool" style="left: 40%"></div>';
            } else {
                moggerBox.innerHTML += '<div class="blood-pool" style="left: 40%"></div>';
            }

            // MOGGER: Ultra Detail
            const mSvg = `
                <div class="${isMogWin ? 'aura-mogger' : ''}" style="bottom: 80px"></div>
                <svg viewBox="0 0 100 120" class="w-48 h-64 z-10 ${isMogWin ? 'win-pose' : 'ko-pose'}">
                    <defs>
                        <linearGradient id="suitGrad" x1="0" y1="0" x2="0" y2="1">
                            <stop offset="0%" stop-color="#333" />
                            <stop offset="100%" stop-color="#111" />
                        </linearGradient>
                    </defs>
                    <!-- Body -->
                    <rect x="20" y="45" width="60" height="65" fill="url(#suitGrad)" /> <!-- V-Taper Suit -->
                    <path d="M20 45 L50 110 L80 45 Z" fill="#1a1a1a" /> <!-- Muscle shadow -->
                    <path d="M42 45 L50 65 L58 45 Z" fill="#fff" /> <!-- Crisp White Shirt -->
                    <rect x="49" y="45" width="2" height="25" fill="#ff00ff" /> <!-- Neon Tie -->
                    
                    <!-- Arms -->
                    <rect x="5" y="48" width="16" height="40" fill="#222" rx="4" />
                    <rect x="79" y="48" width="16" height="40" fill="#222" rx="4" />
                    <rect x="5" y="85" width="16" height="12" fill="#e0ac69" />
                    <rect x="79" y="85" width="16" height="12" fill="#e0ac69" />

                    <!-- Head -->
                    <rect x="35" y="10" width="30" height="35" fill="#e0ac69" />
                    <path d="M35 15 L65 15 L65 10 L60 5 L40 5 L35 10 Z" fill="#111" /> <!-- Pompadour -->
                    <rect x="37" y="22" width="26" height="7" fill="#000" /> <!-- Sunglasses -->
                    <rect x="37" y="22" width="10" height="2" fill="#fff" opacity="0.3" /> <!-- Glass shine -->
                    <path d="M35 38 L50 45 L65 38 Z" fill="#c68642" /> <!-- Strong Jawline -->
                    
                    <!-- Watch/Jewelry -->
                    <rect x="79" y="88" width="16" height="4" fill="#ffd700" />
                </svg>`;
            
            // SOYBOY: Ultra Detail
            const sSvg = `
                <div class="${!isMogWin ? 'aura-soyboy' : ''}" style="bottom: 80px"></div>
                <svg viewBox="0 0 100 120" class="w-48 h-64 z-10 ${!isMogWin ? 'win-pose' : 'ko-pose'}">
                    <!-- Body -->
                    <rect x="30" y="55" width="40" height="50" fill="#444" /> <!-- Hoodie -->
                    <rect x="35" y="65" width="30" height="30" fill="#666" rx="2" /> <!-- Pocket -->
                    <rect x="49" y="55" width="2" height="50" fill="#222" /> <!-- Zipper -->
                    
                    <!-- Head -->
                    <rect x="38" y="25" width="24" height="30" fill="#f3d2c1" />
                    <path d="M38 25 L62 25 L62 20 L55 15 L45 15 L38 20 Z" fill="#8b4513" /> <!-- Messy Gamer Hair -->
                    
                    <!-- Headset -->
                    <rect x="35" y="30" width="5" height="12" fill="#111" rx="2" />
                    <rect x="60" y="30" width="5" height="12" fill="#111" rx="2" />
                    <path d="M35 30 Q50 15 65 30" fill="none" stroke="#111" stroke-width="3" />
                    
                    <!-- Face -->
                    <circle cx="44" cy="38" r="4" fill="none" stroke="#000" stroke-width="1" /> <!-- Glasses -->
                    <circle cx="56" cy="38" r="4" fill="none" stroke="#000" stroke-width="1" />
                    <rect x="48" y="38" width="4" height="0.5" fill="#000" />
                    <circle cx="50" cy="46" r="2.5" fill="#000" opacity="0.7" /> <!-- Soy mouth -->
                    
                    <!-- Arms -->
                    <rect x="22" y="60" width="10" height="35" fill="#444" />
                    <rect x="68" y="60" width="10" height="35" fill="#444" />
                    <rect x="22" y="92" width="10" height="8" fill="#f3d2c1" />
                    <rect x="68" y="92" width="10" height="8" fill="#f3d2c1" />
                </svg>`;

            moggerBox.innerHTML += mSvg;
            soyboyBox.innerHTML += sSvg;
        };

        let myChart;
        function update() {
            const data = getInputs();
            const mNoDP = calcMortgage(data.propCost, data.interestRate, data.loanTerm);
            const mWithDP = calcMortgage(data.propCost - data.downPayment, data.interestRate, data.loanTerm);
            const diffSavings = Math.max(0, mNoDP - mWithDP);
            
            document.getElementById('monthly-diff').innerText = `$${Math.round(diffSavings).toLocaleString()}`;
            document.getElementById('monthlyInvestSoyboy').value = Math.round(diffSavings);

            const labels = [];
            const valMogger = [];
            const valSoyboy = [];
            const breakdown = { mogger: [], soyboy: [] };

            const rI = data.investReturn / 100;
            const rP = data.growthRate / 100;

            for (let t = 0; t <= data.timeHorizon; t++) {
                labels.push(`YR ${t}`);
                const propVal = data.propCost * Math.pow(1 + rP, t);
                
                // Mogger Logic: Invests the down payment amount immediately
                const invMogger = data.downPayment * Math.pow(1 + rI, t);
                valMogger.push(Math.round(propVal + invMogger));
                breakdown.mogger.push({ prop: propVal, inv: invMogger });

                // Soyboy Logic: Invests the monthly savings difference
                let invSoyboy = 0;
                if (t > 0) {
                    const mRate = rI / 12;
                    invSoyboy = diffSavings * ((Math.pow(1 + mRate, t * 12) - 1) / mRate);
                }
                valSoyboy.push(Math.round(propVal + invSoyboy));
                breakdown.soyboy.push({ prop: propVal, inv: invSoyboy });
            }

            const finalM = valMogger[valMogger.length - 1];
            const finalS = valSoyboy[valSoyboy.length - 1];
            const winner = finalM > finalS ? 'MOGGER' : 'SOYBOY';

            document.getElementById('winner-text').innerText = `${winner} DOMINATES!`;
            document.getElementById('final-mogger').innerText = `$${finalM.toLocaleString()}`;
            document.getElementById('final-soyboy').innerText = `$${finalS.toLocaleString()}`;
            
            const maxVal = Math.max(finalM, finalS);
            const mPct = Math.round((finalM / maxVal) * 100);
            const sPct = Math.round((finalS / maxVal) * 100);
            
            document.getElementById('mogger-health').style.width = mPct + '%';
            document.getElementById('soyboy-health').style.width = sPct + '%';
            document.getElementById('mogger-hp-text').innerText = mPct + '% HP';
            document.getElementById('soyboy-hp-text').innerText = sPct + '% HP';

            renderSprites(winner);

            if (myChart) myChart.destroy();
            const ctx = document.getElementById('mainChart').getContext('2d');
            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels,
                    datasets: [
                        { 
                            label: 'MOGGER EQUITY', 
                            data: valMogger, 
                            borderColor: '#ff00ff', 
                            borderWidth: 5, 
                            pointRadius: 4,
                            pointBackgroundColor: '#fff',
                            fill: true, 
                            backgroundColor: 'rgba(255,0,255,0.05)', 
                            breakdown: breakdown.mogger 
                        },
                        { 
                            label: 'SOYBOY EQUITY', 
                            data: valSoyboy, 
                            borderColor: '#00ffff', 
                            borderWidth: 5, 
                            pointRadius: 4,
                            pointBackgroundColor: '#fff',
                            fill: true, 
                            backgroundColor: 'rgba(0,255,255,0.05)', 
                            breakdown: breakdown.soyboy 
                        }
                    ]
                },
                options: {
                    responsive: true,
                    interaction: { mode: 'index', intersect: false },
                    plugins: {
                        legend: { labels: { color: '#fff', font: { family: "'Press Start 2P'", size: 8 } } },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.9)',
                            titleFont: { family: "'Press Start 2P'", size: 10 },
                            bodyFont: { family: "'Press Start 2P'", size: 8 },
                            padding: 15,
                            borderColor: '#555',
                            borderWidth: 2,
                            callbacks: {
                                label: (context) => {
                                    const b = context.dataset.breakdown[context.dataIndex];
                                    return [
                                        ` TOTAL: $${context.parsed.y.toLocaleString()}`,
                                        ` ASSET: $${Math.round(b.prop).toLocaleString()}`,
                                        ` STOCKS: $${Math.round(b.inv).toLocaleString()}`
                                    ];
                                }
                            }
                        }
                    },
                    scales: {
                        y: { grid: { color: '#222' }, ticks: { color: '#888', font: { size: 8 } } },
                        x: { grid: { color: '#222' }, ticks: { color: '#888', font: { size: 8 } } }
                    }
                }
            });
        }

        document.querySelectorAll('input').forEach(input => input.addEventListener('input', update));
        window.onload = update;
    </script>
</body>
</html>
